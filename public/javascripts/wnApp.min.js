(function(){angular.module("wnApp",["ngRoute","ui.bootstrap","flow"]);function o(o,t){o.when("/",{templateUrl:"/home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/politica",{templateUrl:"/home/home.view.html",controller:"pageCtrl",controllerAs:"vm"}).when("/deportes",{templateUrl:"/home/home.view.html",controller:"pageCtrl",controllerAs:"vm"}).when("/farandula",{templateUrl:"/home/home.view.html",controller:"pageCtrl",controllerAs:"vm"}).when("/social",{templateUrl:"/home/home.view.html",controller:"pageCtrl",controllerAs:"vm"}).when("/noticia/:idnoticia",{templateUrl:"/noticiaDetalle/noticiaDetalle.view.html",controller:"noticiaDetalleCtrl",controllerAs:"vm"}).when("/login",{templateUrl:"/aunt/login/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).when("/registro",{templateUrl:"/aunt/registro/registro.view.html",controller:"registerCtrl",controllerAs:"vm"}).when("/about",{templateUrl:"/home/about.view.html"}).otherwise({redirectTo:"/"});t.html5Mode({enabled:true,requireBase:false})}angular.module("wnApp").config(["$routeProvider","$locationProvider",o])})();(function(){function o(o,t){var e=function(o){t.localStorage["wn-token"]=o};var n=function(){return t.localStorage["wn-token"]};var r=function(){var o=n();if(o){var e=JSON.parse(t.atob(o.split(".")[1]));return e.exp>Date.now()/1e3}else{return false}};var a=function(){if(r()){var o=n();var e=JSON.parse(t.atob(o.split(".")[1]));return{email:e.email,name:e.name}}};register=function(t){return o.post("/api/register",t).success(function(o){e(o.token)})};login=function(t){return o.post("/api/login",t).success(function(o){e(o.token)})};logout=function(){t.localStorage.removeItem("wn-token")};return{currentUser:a,saveToken:e,isLoggedIn:r,getToken:n,register:register,login:login,logout:logout}}o.$inject=["$http","$window"];angular.module("wnApp").service("authentication",o)})();(function(){function o(o,t){var e=function(){return o.get("/api/noticias")};var n=function(t){return o.get("/api/noticias/tipo?tipoid="+t)};var r=function(t){return o.get("/api/noticia/"+t)};var a=function(t){return o.post("/api/noticia",t)};var i=function(e,n){return o.post("/api/noticia/"+e+"/comentario",n,{headers:{Authorization:"Bearer "+t.getToken()}})};var l=function(e){var n=new FormData;n.append("file",e.img);n.append("titulo",e.titulo);n.append("tipo",e.tipo);n.append("lugar",e.lugar);n.append("noticia",e.noticia);return o.post("/api/noticia/prueba",n,{headers:{"Content-Type":undefined,Authorization:"Bearer "+t.getToken()}})};return{getData:e,tipoData:n,getNoticia:r,newNoticia:a,addNewComentario:i,newNoticiaImg:l}}o.$inject=["$http","authentication"];angular.module("wnApp").service("wnData",o)})();(function(){angular.module("wnApp").directive("footerGeneric",o);function o(){return{restrict:"EA",templateUrl:"/common/directivas/footer/footerGeneric.template.html"}}})();(function(){angular.module("wnApp").directive("navigator",o);function o(){return{restrict:"EA",templateUrl:"/common/directivas/navigation/navigator.template.html",controller:"navigationCtrl as navvm"}}})();(function(){function o(o,t){var e=this;e.currentPath=o.path();e.isLoggedIn=t.isLoggedIn();e.currentUser=t.currentUser();e.logout=function(){t.logout();o.path("/")}}o.$inject=["$location","authentication"];angular.module("wnApp").controller("navigationCtrl",o)})();(function(){var o=function(o,t,e){var n=this;n.isLoggedIn=e.isLoggedIn();t.getData().success(function(o){n.noticias=o}).error(function(o){console.log(o)});n.popupPublForm=function(){var t=o.open({templateUrl:"/publicarModal/publicarModal.view.html",controller:"publicarModalCtrl as vm"});t.result.then(function(o){n.noticias.push(o)})}};o.$inject=["$uibModal","wnData","authentication"];angular.module("wnApp").controller("homeCtrl",o)})();(function(){var o=function(o,t,e,n){var r=this;r.isLoggedIn=n.isLoggedIn();var a=o.path().split("/");e.tipoData(a[1]).success(function(o){r.noticias=o}).error(function(o){console.log(o)});r.popupPublForm=function(){var o=t.open({templateUrl:"/publicarModal/publicarModal.view.html",controller:"publicarModalCtrl as vm"});o.result.then(function(o){r.noticias.push(o)})}};o.$inject=["$location","$uibModal","wnData","authentication"];angular.module("wnApp").controller("pageCtrl",o)})();(function(){function o(o,t){var e=this;e.pageHeader={title:"Sign in"};e.credentials={name:"",email:"",password:""};e.returnPage=o.search().page||"/";e.onSubmit=function(){e.formError="";if(!e.credentials.email||!e.credentials.password){e.formError="All fields required, please try again";return false}else{e.doLogin()}};e.doLogin=function(){e.formError="";console.log("entra doregister");t.login(e.credentials).error(function(o){e.formError=o}).then(function(){o.search("page",null);o.path(e.returnPage)})}}o.$inject=["$location","authentication"];angular.module("wnApp").controller("loginCtrl",o)})();(function(){function o(o,t){var e=this;e.pageHeader={title:"Create a new Loc8r account"};e.compassword="";e.credentials={name:"",email:"",password:""};e.returnPage=o.search().page||"/";e.onSubmit=function(){e.formError="";if(!e.credentials.name||!e.credentials.email||!e.credentials.password||!e.compassword){e.formError="All fields required, please try again";return false}else{if(e.credentials.password!=e.compassword){e.formError="password diferetes"}else{e.doRegister()}}};e.doRegister=function(){e.formError="";console.log("entra doregister");t.register(e.credentials).error(function(o){e.formError=o}).then(function(){o.search("page",null);o.path(e.returnPage)})}}o.$inject=["$location","authentication"];angular.module("wnApp").controller("registerCtrl",o)})();(function(){var o=function(o,t,e,n){var r=this;r.isLoggedIn=n.isLoggedIn();r.idnoticia=o.idnoticia;r.noticia={titulo:"",importancia:"",vistas:"",cuerpo:"",lugar:""};e.getNoticia(r.idnoticia).success(function(o){r.noticia=o}).error(function(o){console.log(o)});r.popupPublForm=function(){var o=t.open({templateUrl:"/comentarioAddModal/comentarioAddModal.view.html",controller:"comentarioAddModalCtrl as vm",resolve:{noticiaData:function(){return{noticiaid:r.idnoticia,titulo:r.noticia.titulo}}}});o.result.then(function(o){console.log(o);r.noticia=o})}};o.$inject=["$routeParams","$uibModal","wnData","authentication"];angular.module("wnApp").controller("noticiaDetalleCtrl",o)})();(function(){var o=function(o,t){var e=this;e.onSubmit=function(){e.formError="";if(!e.formData.titulo||!e.formData.tipo||!e.formData.lugar||!e.formData.noticia){e.formError="Todos los campos son requeridos, porfavor intente denuevo";return false}else{console.log(e.formData);t.newNoticiaImg(e.formData).success(function(o){e.modal.close(o)}).error(function(o){console.log(o);e.formError="Tu noticia no fue guardada, porfavor intente denuevo."});return false}};e.foto="entrtsds";e.onclickFoto=function(){console.log(e.foto)};e.modal={close:function(t){o.close(t)},cancel:function(){o.dismiss("cancel")}}};o.$inject=["$uibModalInstance","wnData"];angular.module("wnApp").controller("publicarModalCtrl",o)})();(function(){var o=function(o,t,e){var n=this;n.noticia=t;n.formData={comentario:""};n.onSubmit=function(){n.formError="";if(!n.formData.comentario){n.formError="Todos los campos son requeridos, porfavor intente denuevo";return false}else{e.addNewComentario(n.noticia.noticiaid,n.formData).success(function(o){n.modal.close(o.comentario)}).error(function(o){console.log(o);n.formError="Tu noticia no fue guardada, porfavor intente denuevo."});return false}};n.modal={close:function(t){o.close(t)},cancel:function(){o.dismiss("cancel")}}};o.$inject=["$uibModalInstance","noticiaData","wnData"];angular.module("wnApp").controller("comentarioAddModalCtrl",o)})();